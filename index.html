<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>ุงูุงุณุชุนูุงู ุนู ูุชูุฌุฉ ุงูุทุงูุจ</title>

<style>
body{
  font-family: Tahoma, Arial, sans-serif;
  background:#f4f6f8;
}

/* ===== ูุงุฌูุฉ ุงูุจุญุซ ===== */
.box{
  max-width:480px;
  margin:20px auto;
  background:#fff;
  padding:20px;
  border-radius:10px;
  box-shadow:0 0 10px #ccc;
}

button{
  width:100%;
  padding:10px;
  background:#0a7cff;
  color:#fff;
  border:none;
  border-radius:5px;
  cursor:pointer;
  margin-top:6px;
}

table{
  width:100%;
  border-collapse:collapse;
  margin-top:10px;
}

td,th{
  border:1px solid #000;
  padding:5px;
  font-size:13px;
  text-align:center;
}

/* ===== ุงูุชูุฑูุฑ ุงููุฒุงุฑู ===== */
#officialReport{
  width:210mm;
  min-height:297mm;
  padding:10mm;
  background:#fff;
  display:none;
}

.small{font-size:11px}
.center{text-align:center}
.right{text-align:right}
.no-border{border:none}

/* ุชุญุณูู ุงููุต ุงูุนุฑุจู */
#officialReport{
  word-spacing:3px;
  letter-spacing:0.3px;
}

@media print{
  body *{visibility:hidden;}
  #officialReport, #officialReport *{visibility:visible;}
  #officialReport{
    position:absolute;
    right:0;
    top:0;
  }
}
</style>
</head>

<body>

<!-- ===== ูุงุฌูุฉ ุงูุจุญุซ ===== -->
<div class="box">
  <h3 style="text-align:center;">ุงูุงุณุชุนูุงู ุนู ูุชูุฌุฉ ุงูุทุงูุจ</h3>

  <input id="civilId" placeholder="ุงูุฑูู ุงููุฏูู"
         style="width:100%;padding:8px">

  <button onclick="getResult()">ุนุฑุถ ุงููุชูุฌุฉ</button>
  <button onclick="printResult()">๐จ๏ธ ุทุจุงุนุฉ ุงูุชูุฑูุฑ ุงูุฑุณูู</button>
  <button onclick="downloadPDF()">๐ ุชุญููู PDF</button>

  <!-- ุนุฑุถ ูุฎุชุตุฑ -->
  <div id="htmlResult" style="display:none;">
    <h4>ูุชูุฌุฉ ุงูุทุงูุจ</h4>
    <p><b>ุงุณู ุงูุทุงูุจ:</b> <span id="h_name"></span></p>
    <p><b>ุงูุฑูู ุงููุฏูู:</b> <span id="h_civil"></span></p>
    <p><b>ุงูุตู:</b> <span id="h_grade"></span></p>
  </div>
</div>

<!-- ================================================================= -->
<!-- ================== ุงูุชูุฑูุฑ ุงููุฒุงุฑู ุงููุทุงุจู ====================== -->
<!-- ================================================================= -->
<div id="officialReport">

<!-- ===== ุงูุชุฑููุณุฉ ===== -->
<table class="no-border">
<tr class="no-border">
  <td class="no-border center" width="20%">
    <img src="logo.png" height="60">
  </td>
  <td class="no-border center" width="60%">
    <b>ุณูุทูุฉ ุนูุงู<br>ูุฒุงุฑุฉ ุงูุชุฑุจูุฉ ูุงูุชุนููู</b><br>
    <b>ูุดู ุฏุฑุฌุงุช ุงูุทุงูุจ ูู ุงููุตู ุงูุฏุฑุงุณู</b><br>
    <span class="small">TRANSCRIPT OF STUDENT ATTAINMENT AT THE END OF THE SEMESTER</span><br>
    <span class="small">ุงูุนุงู ุงูุฏุฑุงุณู : 2025 / 2026</span>
  </td>
  <td class="no-border"></td>
</tr>
</table>

<br>

<!-- ===== ุจูุงูุงุช ุงูุทุงูุจ ===== -->
<table>
<tr>
  <td>ุงุณู ุงูุทุงูุจ</td><td id="s_name"></td>
  <td>ุงูุฑูู ุงููุฏูู</td><td id="s_civil"></td>
</tr>
<tr>
  <td>ุงูุตู ูุงูุดุนุจุฉ</td><td id="s_grade"></td>
  <td>ุชุงุฑูุฎ ุงููููุงุฏ</td><td id="s_birth"></td>
</tr>
<tr>
  <td>ุงููุฏุฑุณุฉ</td>
  <td colspan="3">ูุนููุฉ ุจู ุดูุณ ููุชุนููู ุงูุฃุณุงุณู (5โ12)</td>
</tr>
<tr>
  <td>ุงููุญุงูุธุฉ</td>
  <td colspan="3">ูุญุงูุธุฉ ุฌููุจ ุงูุจุงุทูุฉ</td>
</tr>
</table>

<br>

<!-- ===== ุฌุฏูู ุงูููุงุฏ ===== -->
<table>
<tr>
  <th>ุงููุงุฏุฉ<br><span class="small">SUBJECT</span></th>
  <th>ุนุฏุฏ ุงูุญุตุต<br><span class="small">PERIODS</span></th>
  <th>ุงูุฑูุฒ<br><span class="small">CODE</span></th>
  <th>ุงูุชูุฏูุฑ<br><span class="small">GRADE</span></th>
  <th>ุงูุฏุฑุฌุฉ<br><span class="small">MARK</span></th>
</tr>

<tr><td>ุงูุชุฑุจูุฉ ุงูุฅุณูุงููุฉ<br><span class="small">Islamic Education</span></td><td>5</td><td>ุฃ</td><td>A</td><td id="m_islamic"></td></tr>
<tr><td>ุงููุบุฉ ุงูุนุฑุจูุฉ<br><span class="small">Arabic Language</span></td><td>7</td><td>ุฃ</td><td>A</td><td id="m_arabic"></td></tr>
<tr><td>ุงููุบุฉ ุงูุฅูุฌููุฒูุฉ<br><span class="small">English Language</span></td><td>5</td><td>ุฃ</td><td>A</td><td id="m_english"></td></tr>
<tr><td>ุงูุฑูุงุถูุงุช<br><span class="small">Mathematics</span></td><td>7</td><td>ุฃ</td><td>A</td><td id="m_math"></td></tr>
<tr><td>ุงูุนููู<br><span class="small">Science</span></td><td>6</td><td>ุฃ</td><td>A</td><td id="m_science"></td></tr>
<tr><td>ุงูุฏุฑุงุณุงุช ุงูุงุฌุชูุงุนูุฉ<br><span class="small">Social Studies</span></td><td>4</td><td>ุฃ</td><td>A</td><td id="m_social"></td></tr>
<tr><td>ุงูููุงุฑุงุช ุงูุญูุงุชูุฉ<br><span class="small">Life Skills</span></td><td>1</td><td>ุฃ</td><td>A</td><td id="m_life"></td></tr>
<tr><td>ุชูููุฉ ุงููุนูููุงุช<br><span class="small">Information Technology</span></td><td>2</td><td>ุฃ</td><td>A</td><td id="m_it"></td></tr>
<tr><td>ุงูุฑูุงุถุฉ ุงููุฏุฑุณูุฉ<br><span class="small">School Sports</span></td><td>1</td><td>ุฃ</td><td>A</td><td id="m_sport"></td></tr>
<tr><td>ุงููููู ุงูุชุดููููุฉ<br><span class="small">Arts</span></td><td>1</td><td>ุฃ</td><td>A</td><td id="m_art"></td></tr>
<tr><td>ุงูููุงุฑุงุช ุงูููุณูููุฉ<br><span class="small">Musical Skills</span></td><td>1</td><td>ุฃ</td><td>A</td><td id="m_music"></td></tr>
</table>

<br>

<!-- ===== ุฌุฏูู ุงูุชูุฏูุฑุงุช ===== -->
<table>
<tr><th>ุงูุฑูุฒ</th><th>ุงูุฏุฑุฌุฉ</th><th>ุงููุตู</th></tr>
<tr><td>A</td><td>90 โ 100</td><td>ููุชุงุฒ / EXCELLENT</td></tr>
<tr><td>B</td><td>80 โ 89</td><td>ุฌูุฏ ุฌุฏูุง / VERY GOOD</td></tr>
<tr><td>C</td><td>65 โ 79</td><td>ุฌูุฏ / GOOD</td></tr>
<tr><td>D</td><td>50 โ 64</td><td>ููุจูู / SATISFACTORY</td></tr>
<tr><td>E</td><td>0 โ 49</td><td>ูุญุชุงุฌ ุฅูู ูุณุงุนุฏุฉ / UNSATISFACTORY</td></tr>
</table>

<br>

<!-- ===== ุงูุชุฐููู ===== -->
<table class="no-border">
<tr class="no-border">
  <td class="no-border">ููุงุญุธุงุช ููู ุงูุฃูุฑ ูุชูููุนู :</td>
  <td class="no-border center">ูุฏูุฑ ุงููุฏุฑุณุฉ<br>HEADMASTER</td>
</tr>
<tr class="no-border">
  <td class="no-border">ุชุงุฑูุฎ ุงูุฅุตุฏุงุฑ : 2026/01/05</td>
  <td class="no-border"></td>
</tr>
</table>

</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

<script>
function getResult(){
  const civilId=document.getElementById("civilId").value.trim();
  if(!civilId) return;

  fetch("https://script.google.com/macros/s/AKfycbwMWhQZhd26RbgJASv_Y4jFemW3YACA2FzOckwEUJIehj6xs4gNRw1nn4HOCg7t81EVRw/exec?civilId="+civilId)
  .then(r=>r.json())
  .then(d=>{
    if(!d.found){alert("ุงูุฑูู ุบูุฑ ููุฌูุฏ");return;}

    htmlResult.style.display="block";

    h_name.innerText=d.name;
    h_civil.innerText=d.civilId;
    h_grade.innerText=d.grade || "";

    s_name.innerText=d.name;
    s_civil.innerText=d.civilId;
    s_grade.innerText=d.grade || "";
    s_birth.innerText=d.birth || "";

    m_islamic.innerText=d.islamic;
    m_arabic.innerText=d.arabic;
    m_english.innerText=d.english || "";
    m_math.innerText=d.math;
    m_science.innerText=d.science;
    m_social.innerText=d.social;
    m_life.innerText=d.life;
    m_it.innerText=d.it;
    m_sport.innerText=d.sport;
    m_art.innerText=d.art;
    m_music.innerText=d.music;
  });
}

function printResult(){
  const r=document.getElementById("officialReport");
  r.style.display="block";
  window.print();
  r.style.display="none";
}

function downloadPDF(){
  const r=document.getElementById("officialReport");
  r.style.display="block";
  html2pdf().from(r).save("ูุดู_ุฏุฑุฌุงุช_ุงูุทุงูุจ.pdf")
  .then(()=>r.style.display="none");
}
</script>

</body>
</html>
