<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>ูุดู ุฏุฑุฌุงุช ุงูุทุงูุจ</title>

<style>
body{
  font-family: Tahoma, Arial, sans-serif;
  background:#f4f6f8;
}

.box{
  max-width:480px;
  margin:20px auto;
  background:#fff;
  padding:20px;
  border-radius:10px;
  box-shadow:0 0 10px #ccc;
}

button{
  width:100%;
  padding:10px;
  background:#0a7cff;
  color:#fff;
  border:none;
  border-radius:5px;
  cursor:pointer;
  margin-top:5px;
}

table{
  width:100%;
  border-collapse:collapse;
  margin-top:10px;
}

td,th{
  border:1px solid #000;
  padding:6px;
  font-size:13px;
  text-align:center;
}

/* ุชุญุณูู ุงููุต ุงูุนุฑุจู ูู PDF */
#pdfResult{
  font-family: Tahoma, Arial, sans-serif;
  word-spacing:3px;
  letter-spacing:0.3px;
}

#pdfResult td{
  white-space:nowrap;
}

@media print{
  body *{visibility:hidden;}
  #pdfResult,#pdfResult *{visibility:visible;}
  #pdfResult{
    position:absolute;
    right:0;
    top:0;
    width:100%;
  }
}
</style>
</head>

<body>

<div class="box">
  <h3 style="text-align:center;">ุงูุงุณุชุนูุงู ุนู ูุชูุฌุฉ ุงูุทุงูุจ</h3>

  <input id="civilId" placeholder="ุงูุฑูู ุงููุฏูู"
         style="width:100%;padding:8px">

  <button onclick="getResult()">ุนุฑุถ ุงููุชูุฌุฉ</button>
  <button onclick="downloadPDF()">๐ ุชุญููู PDF</button>
  <button onclick="printResult()">๐จ๏ธ ุทุจุงุนุฉ</button>

  <!-- ุนุฑุถ ุงููุชูุฌุฉ ูู ุงูุตูุญุฉ -->
  <div id="htmlResult" style="display:none;">
    <h4>ูุชูุฌุฉ ุงูุทุงูุจ</h4>
    <p><b>ุงุณู ุงูุทุงูุจ:</b> <span id="h_name"></span></p>
    <p><b>ุงูุฑูู ุงููุฏูู:</b> <span id="h_civil"></span></p>
    <p><b>ุงูุตู:</b> <span id="h_grade"></span></p>

    <table>
      <tr><th>ุงููุงุฏุฉ</th><th>ุงูุฏุฑุฌุฉ</th></tr>
      <tr><td>ุงูุชุฑุจูุฉ ุงูุฅุณูุงููุฉ</td><td id="h_islamic"></td></tr>
      <tr><td>ุงููุบุฉ ุงูุนุฑุจูุฉ</td><td id="h_arabic"></td></tr>
      <tr><td>ุงูุฑูุงุถูุงุช</td><td id="h_math"></td></tr>
      <tr><td>ุงูุนููู</td><td id="h_science"></td></tr>
      <tr><td>ุงูุฏุฑุงุณุงุช ุงูุงุฌุชูุงุนูุฉ</td><td id="h_social"></td></tr>
      <tr><td>ุงูููุงุฑุงุช ุงูุญูุงุชูุฉ</td><td id="h_life"></td></tr>
      <tr><td>ุชูููุฉ ุงููุนูููุงุช</td><td id="h_it"></td></tr>
      <tr><td>ุงูุฑูุงุถุฉ ุงููุฏุฑุณูุฉ</td><td id="h_sport"></td></tr>
      <tr><td>ุงููููู ุงูุชุดููููุฉ</td><td id="h_art"></td></tr>
      <tr><td>ุงูููุงุฑุงุช ุงูููุณูููุฉ</td><td id="h_music"></td></tr>
    </table>
  </div>
</div>

<!-- ===== ุชูุฑูุฑ PDF ===== -->
<div id="pdfResult" style="display:none; direction:rtl;">

  <div style="text-align:center;border-bottom:2px solid #000;padding-bottom:10px;">
    <img src="logo.png" style="height:70px"><br>
    <b>ุณูุทูุฉ ุนูุงู<br>ูุฒุงุฑุฉ ุงูุชุฑุจูุฉ ูุงูุชุนููู</b>
    <h3>ูุดู ุฏุฑุฌุงุช ุงูุทุงูุจ ูููุตู ุงูุฏุฑุงุณู</h3>
    <div>ุงูุนุงู ุงูุฏุฑุงุณู: 2025 / 2026</div>
  </div>

  <table>
    <tr>
      <td><b>ุงุณู ุงูุทุงูุจ</b></td><td id="pdfName"></td>
      <td><b>ุงูุฑูู ุงููุฏูู</b></td><td id="pdfCivil"></td>
    </tr>
    <tr>
      <td><b>ุงูุตู</b></td><td id="pdfGrade"></td>
      <td></td><td></td>
    </tr>
  </table>

  <!-- ุฌุฏูู ุงูููุงุฏ -->
  <table>
    <tr><th>ุงููุงุฏุฉ</th><th>ุงูุฏุฑุฌุฉ</th></tr>
    <tr><td>ุงูุชุฑุจูุฉ ุงูุฅุณูุงููุฉ</td><td id="m_islamic"></td></tr>
    <tr><td>ุงููุบุฉ ุงูุนุฑุจูุฉ</td><td id="m_arabic"></td></tr>
    <tr><td>ุงูุฑูุงุถูุงุช</td><td id="m_math"></td></tr>
    <tr><td>ุงูุนููู</td><td id="m_science"></td></tr>
    <tr><td>ุงูุฏุฑุงุณุงุช ุงูุงุฌุชูุงุนูุฉ</td><td id="m_social"></td></tr>
    <tr><td>ุงูููุงุฑุงุช ุงูุญูุงุชูุฉ</td><td id="m_life"></td></tr>
    <tr><td>ุชูููุฉ ุงููุนูููุงุช</td><td id="m_it"></td></tr>
    <tr><td>ุงูุฑูุงุถุฉ ุงููุฏุฑุณูุฉ</td><td id="m_sport"></td></tr>
    <tr><td>ุงููููู ุงูุชุดููููุฉ</td><td id="m_art"></td></tr>
    <tr><td>ุงูููุงุฑุงุช ุงูููุณูููุฉ</td><td id="m_music"></td></tr>
  </table>

</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

<script>
function getResult(){
  const civilId=document.getElementById("civilId").value.trim();
  if(!civilId) return;

  fetch("https://script.google.com/macros/s/AKfycbwMWhQZhd26RbgJASv_Y4jFemW3YACA2FzOckwEUJIehj6xs4gNRw1nn4HOCg7t81EVRw/exec?civilId="+civilId)
  .then(r=>r.json())
  .then(d=>{
    if(!d.found){alert("ุงูุฑูู ุบูุฑ ููุฌูุฏ");return;}

    htmlResult.style.display="block";

    h_name.innerText=d.name;
    h_civil.innerText=d.civilId;
    h_grade.innerText=d.grade || "";

    h_islamic.innerText=d.islamic;
    h_arabic.innerText=d.arabic;
    h_math.innerText=d.math;
    h_science.innerText=d.science;
    h_social.innerText=d.social;
    h_life.innerText=d.life;
    h_it.innerText=d.it;
    h_sport.innerText=d.sport;
    h_art.innerText=d.art;
    h_music.innerText=d.music;

    pdfName.innerText=d.name;
    pdfCivil.innerText=d.civilId;
    pdfGrade.innerText=d.grade || "";

    m_islamic.innerText=d.islamic;
    m_arabic.innerText=d.arabic;
    m_math.innerText=d.math;
    m_science.innerText=d.science;
    m_social.innerText=d.social;
    m_life.innerText=d.life;
    m_it.innerText=d.it;
    m_sport.innerText=d.sport;
    m_art.innerText=d.art;
    m_music.innerText=d.music;
  });
}

function downloadPDF(){
  const el=document.getElementById("pdfResult");
  el.style.display="block";
  html2pdf().from(el).save("ูุชูุฌุฉ_ุงูุทุงูุจ.pdf").then(()=>el.style.display="none");
}

function printResult(){
  const el=document.getElementById("pdfResult");
  el.style.display="block";
  window.print();
  el.style.display="none";
}
</script>

</body>
</html>
