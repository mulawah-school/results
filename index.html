<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>ุงูุงุณุชุนูุงู ุนู ูุชูุฌุฉ ุงูุทุงูุจ</title>

<style>
/* ===== ุนุงู ===== */
body{
  font-family: Tahoma, Arial, sans-serif;
  background:#f4f6f8;
}

.box{
  max-width:520px;
  margin:20px auto;
  background:#fff;
  padding:20px;
  border-radius:10px;
  box-shadow:0 0 10px #ccc;
}

input{
  width:100%;
  padding:8px;
  margin-bottom:10px;
}

button{
  width:100%;
  padding:10px;
  background:#0a7cff;
  color:#fff;
  border:none;
  border-radius:5px;
  cursor:pointer;
  margin-top:6px;
}

table{
  width:100%;
  border-collapse:collapse;
  margin-top:10px;
}

td,th{
  border:1px solid #000;
  padding:6px;
  font-size:13px;
  text-align:center;
}

/* ===== ุงูุชูุฑูุฑ ุงูุฑุณูู ===== */
#officialReport{
  width:210mm;
  min-height:297mm;
  padding:10mm;
  background:#fff;
  display:none;
  direction:rtl;
  font-family: Tahoma, Arial, sans-serif;
}

/* ุชูุธูู ุงููุต */
#officialReport table{
  table-layout:fixed;
}

#officialReport td,
#officialReport th{
  white-space:normal;
  word-break:normal;
  overflow-wrap:break-word;
  line-height:1.6;
  vertical-align:middle;
}

/* ุงููุต ุงูุฅูุฌููุฒู */
.en{
  display:block;
  direction:ltr;
  text-align:left;
  font-size:11px;
  font-family: Arial, sans-serif;
  margin-top:2px;
}

/* ุจุฏูู ุญุฏูุฏ */
.no-border{
  border:none !important;
}

/* ุทุจุงุนุฉ */
@media print{
  body *{visibility:hidden;}
  #officialReport, #officialReport *{visibility:visible;}
  #officialReport{
    position:absolute;
    right:0;
    top:0;
  }
}
</style>
</head>

<body>

<!-- ===== ูุงุฌูุฉ ุงูุงุณุชุนูุงู ===== -->
<div class="box">
  <h3 style="text-align:center;">ุงูุงุณุชุนูุงู ุนู ูุชูุฌุฉ ุงูุทุงูุจ</h3>

  <input id="civilId" placeholder="ุงูุฑูู ุงููุฏูู">

  <button onclick="getResult()">ุนุฑุถ ุงููุชูุฌุฉ</button>
  <button onclick="printResult()">๐จ๏ธ ุทุจุงุนุฉ ุงูุชูุฑูุฑ ุงูุฑุณูู</button>
  <button onclick="downloadPDF()">๐ ุชุญููู PDF</button>

  <!-- ===== ุนุฑุถ ุงููุชูุฌุฉ ุฏุงุฎู ุงูุตูุญุฉ ===== -->
  <div id="htmlResult" style="display:none;">
    <h4>ูุชูุฌุฉ ุงูุทุงูุจ</h4>

    <p><b>ุงุณู ุงูุทุงูุจ:</b> <span id="h_name"></span></p>
    <p><b>ุงูุฑูู ุงููุฏูู:</b> <span id="h_civil"></span></p>
    <p><b>ุงูุตู:</b> <span id="h_grade"></span></p>

    <table>
      <tr><th>ุงููุงุฏุฉ</th><th>ุงูุฏุฑุฌุฉ</th></tr>
      <tr><td>ุงูุชุฑุจูุฉ ุงูุฅุณูุงููุฉ</td><td id="h_islamic"></td></tr>
      <tr><td>ุงููุบุฉ ุงูุนุฑุจูุฉ</td><td id="h_arabic"></td></tr>
      <tr><td>ุงููุบุฉ ุงูุฅูุฌููุฒูุฉ</td><td id="h_english"></td></tr>
      <tr><td>ุงูุฑูุงุถูุงุช</td><td id="h_math"></td></tr>
      <tr><td>ุงูุนููู</td><td id="h_science"></td></tr>
      <tr><td>ุงูุฏุฑุงุณุงุช ุงูุงุฌุชูุงุนูุฉ</td><td id="h_social"></td></tr>
      <tr><td>ุงูููุงุฑุงุช ุงูุญูุงุชูุฉ</td><td id="h_life"></td></tr>
      <tr><td>ุชูููุฉ ุงููุนูููุงุช</td><td id="h_it"></td></tr>
      <tr><td>ุงูุฑูุงุถุฉ ุงููุฏุฑุณูุฉ</td><td id="h_sport"></td></tr>
      <tr><td>ุงููููู ุงูุชุดููููุฉ</td><td id="h_art"></td></tr>
      <tr><td>ุงูููุงุฑุงุช ุงูููุณูููุฉ</td><td id="h_music"></td></tr>
    </table>
  </div>
</div>

<!-- ================================================================= -->
<!-- ================= ุงูุชูุฑูุฑ ุงููุฒุงุฑู ุงูุฑุณูู ======================= -->
<!-- ================================================================= -->
<div id="officialReport">

<!-- ===== ุงูุชุฑููุณุฉ ===== -->
<div style="text-align:center; margin-bottom:10px;">
  <img src="logo.png" height="70"><br>
  <b>ุณูุทูุฉ ุนูุงู</b><br>
  <b>ูุฒุงุฑุฉ ุงูุชุฑุจูุฉ ูุงูุชุนููู</b><br>
  <b>ูุดู ุฏุฑุฌุงุช ุงูุทุงูุจ ูู ุงููุตู ุงูุฏุฑุงุณู</b><br>
  <span class="en">TRANSCRIPT OF STUDENT ATTAINMENT AT THE END OF THE SEMESTER</span>
  <div>ุงูุนุงู ุงูุฏุฑุงุณู : 2025 / 2026</div>
</div>

<!-- ===== ุจูุงูุงุช ุงูุทุงูุจ ===== -->
<table>
<tr>
  <td>ุงุณู ุงูุทุงูุจ</td><td id="s_name"></td>
  <td>ุงูุฑูู ุงููุฏูู</td><td id="s_civil"></td>
</tr>
<tr>
  <td>ุงูุตู ูุงูุดุนุจุฉ</td><td id="s_grade"></td>
  <td>ุชุงุฑูุฎ ุงููููุงุฏ</td><td id="s_birth"></td>
</tr>
<tr>
  <td>ุงููุฏุฑุณุฉ</td>
  <td colspan="3">ูุนููุฉ ุจู ุดูุณ ููุชุนููู ุงูุฃุณุงุณู (5โ12)</td>
</tr>
<tr>
  <td>ุงููุญุงูุธุฉ</td>
  <td colspan="3">ูุญุงูุธุฉ ุฌููุจ ุงูุจุงุทูุฉ</td>
</tr>
</table>

<!-- ===== ุฌุฏูู ุงูููุงุฏ ===== -->
<table>
<tr>
  <th>ุงููุงุฏุฉ<br><span class="en">SUBJECT</span></th>
  <th>ุงูุญุตุต<br><span class="en">PERIODS</span></th>
  <th>ุงูุฑูุฒ</th>
  <th>ุงูุชูุฏูุฑ</th>
  <th>ุงูุฏุฑุฌุฉ</th>
</tr>

<tr>
  <td>ุงูุชุฑุจูุฉ ุงูุฅุณูุงููุฉ<span class="en">Islamic Education</span></td>
  <td>5</td><td>ุฃ</td><td>A</td><td id="m_islamic"></td>
</tr>
<tr>
  <td>ุงููุบุฉ ุงูุนุฑุจูุฉ<span class="en">Arabic Language</span></td>
  <td>7</td><td>ุฃ</td><td>A</td><td id="m_arabic"></td>
</tr>
<tr>
  <td>ุงููุบุฉ ุงูุฅูุฌููุฒูุฉ<span class="en">English Language</span></td>
  <td>5</td><td>ุฃ</td><td>A</td><td id="m_english"></td>
</tr>
<tr>
  <td>ุงูุฑูุงุถูุงุช<span class="en">Mathematics</span></td>
  <td>7</td><td>ุฃ</td><td>A</td><td id="m_math"></td>
</tr>
<tr>
  <td>ุงูุนููู<span class="en">Science</span></td>
  <td>6</td><td>ุฃ</td><td>A</td><td id="m_science"></td>
</tr>
<tr>
  <td>ุงูุฏุฑุงุณุงุช ุงูุงุฌุชูุงุนูุฉ<span class="en">Social Studies</span></td>
  <td>4</td><td>ุฃ</td><td>A</td><td id="m_social"></td>
</tr>
<tr>
  <td>ุงูููุงุฑุงุช ุงูุญูุงุชูุฉ<span class="en">Life Skills</span></td>
  <td>1</td><td>ุฃ</td><td>A</td><td id="m_life"></td>
</tr>
<tr>
  <td>ุชูููุฉ ุงููุนูููุงุช<span class="en">Information Technology</span></td>
  <td>2</td><td>ุฃ</td><td>A</td><td id="m_it"></td>
</tr>
<tr>
  <td>ุงูุฑูุงุถุฉ ุงููุฏุฑุณูุฉ<span class="en">School Sports</span></td>
  <td>1</td><td>ุฃ</td><td>A</td><td id="m_sport"></td>
</tr>
<tr>
  <td>ุงููููู ุงูุชุดููููุฉ<span class="en">Arts</span></td>
  <td>1</td><td>ุฃ</td><td>A</td><td id="m_art"></td>
</tr>
<tr>
  <td>ุงูููุงุฑุงุช ุงูููุณูููุฉ<span class="en">Musical Skills</span></td>
  <td>1</td><td>ุฃ</td><td>A</td><td id="m_music"></td>
</tr>
</table>

</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

<script>
function getResult(){
  const civilId=document.getElementById("civilId").value.trim();
  if(!civilId) return;

  fetch("https://script.google.com/macros/s/AKfycbwMWhQZhd26RbgJASv_Y4jFemW3YACA2FzOckwEUJIehj6xs4gNRw1nn4HOCg7t81EVRw/exec?civilId="+civilId)
  .then(r=>r.json())
  .then(d=>{
    if(!d.found){alert("ุงูุฑูู ุบูุฑ ููุฌูุฏ");return;}

    htmlResult.style.display="block";

    h_name.innerText=d.name;
    h_civil.innerText=d.civilId;
    h_grade.innerText=d.grade || "";

    h_islamic.innerText=d.islamic;
    h_arabic.innerText=d.arabic;
    h_english.innerText=d.english || "";
    h_math.innerText=d.math;
    h_science.innerText=d.science;
    h_social.innerText=d.social;
    h_life.innerText=d.life;
    h_it.innerText=d.it;
    h_sport.innerText=d.sport;
    h_art.innerText=d.art;
    h_music.innerText=d.music;

    s_name.innerText=d.name;
    s_civil.innerText=d.civilId;
    s_grade.innerText=d.grade || "";
    s_birth.innerText=d.birth || "";

    m_islamic.innerText=d.islamic;
    m_arabic.innerText=d.arabic;
    m_english.innerText=d.english || "";
    m_math.innerText=d.math;
    m_science.innerText=d.science;
    m_social.innerText=d.social;
    m_life.innerText=d.life;
    m_it.innerText=d.it;
    m_sport.innerText=d.sport;
    m_art.innerText=d.art;
    m_music.innerText=d.music;
  });
}

function printResult(){
  const r=document.getElementById("officialReport");
  r.style.display="block";
  window.print();
  r.style.display="none";
}

function downloadPDF(){
  const r=document.getElementById("officialReport");
  r.style.display="block";
  html2pdf().from(r).save("ูุดู_ุฏุฑุฌุงุช_ุงูุทุงูุจ.pdf")
  .then(()=>r.style.display="none");
}
</script>

</body>
</html>
